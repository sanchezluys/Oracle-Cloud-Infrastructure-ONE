## IaC Doguito API

- se va a usar el numero 2
- se suprime todo lo anterior
- el numero 2 incluye a doguito-site.service, verificar que las credenciales esten bien en ese archivo
- a los demas archivos como compute.tf se le cambió fueron algunos nombres, asi como en loadbalancer.tf
- se recomienda el clonado del git, esto se configura en cloud-init.yaml
- voy a clonar y se coloca en: https://github.dev/sanchezluys/doguito-app-oci
- es necesario configurar la url wallet y doguito-site.service

    mi repo:
    https://github.com/sanchezluys/doguito-app-oci



![alt iac_1](/imagenes/clase05/iac/image.png)

Pasos:

1.  Almacenamiento - cubos - crea un cubo, todo por defecto, ejemplo nombre: interno
2.  Habilita la visibilidad del cubo de privado a publico
3.  Se cargan al cubo: doguito-site.service 

una vez se tenga el archivo cargado de doguito-site.service se mira en su detalle de objeto la url publica:

![alt iac_2](/imagenes/clase05/iac/image-1.png)

para luego pegarla en: cloud-init.yaml

![alt iac_3](/imagenes/clase05/iac/image-2.png)

![alt iac_4](/imagenes/clase05/iac/image-3.png)

4. ahora el wallet url, en oracle database - bases de datos autonomas - doguito_db - conexion de bases de datos

![alt iac_5](/imagenes/clase05/iac/image-4.png)

descargamos la cartera donde necesitamos la clave, por ejemplo es doguito12345

![alt iac_6](/imagenes/clase05/iac/image-5.png)

![alt iac_7](/imagenes/clase05/iac/image-6.png)

- se descarga y se coloca en la misma carpeta del proyecto

![alt iac_8](/imagenes/clase05/iac/image-7.png)

5. se sube la wallet.zip al cubo, para obtener la url publica del objeto y colocarla en el .yaml, linea 25 

![alt iac_9](/imagenes/clase05/iac/image-8.png)

![alt iac_10](/imagenes/clase05/iac/image-9.png)

6. una vez listo, es necesario volver a comprimir en formato .zip los archivos del proyecto ejemplo doguito-final.zip, que es el archivo que se usará para generar la pila.

![alt iac_11](/imagenes/clase05/iac/image-10.png)




¿Estás listo para crear un pilla customizada para implementar Doguito de manera extremadamente simple y práctica?

Serán necesarios algunos pasos:

    Ajustar el archivo “compute.tf” customizando el nombre de las instancias;
    Ajustar el archivo loadbalancer.tf customizando el nombre del balanceador de cargas y las puertas de conexión;
    Ajustar el archivo “network.tf” incluyendo una regla de ingreso para la puerta 3000;
    Crear un nuevo bucket llamado internal y hacer el upload de los archivos “doguito-site.service” y “Wallet_DOGUITODB.zip”;
    Alterar el “archivo cloud-init.yaml” instalando git, Node.js y los drivers de conexión con la base de datos ORacle. Inserir un comando en el archivo para hacer la descarga y configurar el service de Doguito, además de hacer la descarga de Wallet y la descompactar en el local adecuado, liberando la puerta 3000 en firewall.

Por fin, tenemos que compactar otra vez el archivo “orm-dps-vm2” en un archivo zip que será utilizado para inicializar la pilla del Doguito.

Si tienes alguna pregunta, no dudes en entrar en contacto con otras personas en nuestro fóro.
